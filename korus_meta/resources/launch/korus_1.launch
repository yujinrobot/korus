<!--
  Launches the mighty Korus
  
  In detail:
   * robot core (goo, mechanism model, joint trajectory controller, ...)
   ** uses parameters for Yujin's Korus (V3.1)
   * sensors (if set to true)
 -->
<launch>
  <!-- Parameters for minimal configuration -->
  <arg name="launch_hokuyo"                 value="true"/>
  <arg name="launch_sonars"                 value="false"/>
  <arg name="launch_sensor_3d"              value="false"/>
  <arg name="launch_stargazer"              value="false"/>
  <arg name="launch_gripper_camera"         value="false"/>
  <arg name="launch_sensor_board"           value="false"/>
  <arg name="launch_remocon"                value="false"/>
  <!-- Parameters for move base -->
  <arg name="costmap_sensors"               value="hokuyo"/>
  <!-- Name of the map to use (without extension) and initial position -->
  <arg name="map_name"                      default="$(find yujin_maps)/maps/yujin_edu_room"/>
  <arg name="initial_pose_x"                value="3.0"/>
  <arg name="initial_pose_y"                value="1.0"/>
  <arg name="initial_pose_a"                value="0.0"/>

  <group ns="korus">
    <!--  ************** Korus' minimal configuration **************  -->
    <include file="$(find korus_meta)/resources/launch/minimal_1.launch">
		  <arg name="pot"                       value="false"/>
		  <arg name="launch_hokuyo"             value="$(arg map_name)"/>
		  <arg name="launch_sonars"             value="$(arg map_name)"/>
		  <arg name="launch_sensor_3d"          value="$(arg map_name)"/>
		  <arg name="launch_stargazer"          value="$(arg map_name)"/>
		  <arg name="launch_gripper_camera"     value="$(arg map_name)"/>
		  <arg name="launch_gyro"               value="$(arg map_name)"/>
		  <arg name="launch_sensor_board"       value="$(arg map_name)"/>
		  <arg name="launch_remocon"            value="$(arg map_name)"/>
    </include>

    <!--  ************** Rosnav move base **************  -->
    <include file="$(find korus_meta)/resources/launch/components/move_base.launch">
      <arg name="costmap_sensors" value="$(arg costmap_sensors)"/>
    </include>

    <!--  ************* Navigation manager *************  -->
    <include file="$(find korus_nav_mng)/resources/launch/nav_mng.launch"/>

    <!--  ***************** Map Server *****************  -->
    <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_name).yaml">
      <param name="frame_id" value="/map"/>
    </node>

    <!--  ********** Localization fusion node ***********  -->
    <include file="$(find korus_meta)/resources/launch/components/localize_ekf.launch">
      <arg name="initial_pose_x"   value="$(arg initial_pose_x)"/>
      <arg name="initial_pose_y"   value="$(arg initial_pose_y)"/>
      <arg name="initial_pose_yaw" value="$(arg initial_pose_a)"/>
    </include>

    <!--  ******************** Amcl ********************  -->
    <include file="$(find korus_meta)/resources/launch/components/amcl.launch">
      <arg name="tf_broadcast" value="false"/>
      
      <arg name="initial_pose_x" value="$(arg initial_pose_x)"/>
      <arg name="initial_pose_y" value="$(arg initial_pose_y)"/>
      <arg name="initial_pose_a" value="$(arg initial_pose_a)"/>
    </include>

    <!--  ***** Stargazer map node in localize mode *****  -->
    <include file="$(find korus_meta)/resources/launch/components/stargz_map.launch">
      <arg name="landmarks_file_path" value="$(arg map_name).stgz"/>
      <arg name="operation_mode" value="1"/>
    </include>

    <!--  *********** rapi launch: hce, navi ************  -->
<!--    <include file="$(find korus_meta)/resources/launch/components/rapi.launch"/> -->    
    
  </group>
  
  <!--node pkg="korus_smach" type="head_calibration.py" name="head_calibration"/-->
  
</launch>
